# Лабораторная работа №06

<p align="center">Министерство образования Республики Беларусь</p>
<p align="center">Учреждение образования</p>
<p align="center">"Брестский Государственный технический университет"</p>
<p align="center">Кафедра ИИТ</p>
<br><br><br><br><br><br>
<p align="center"><strong>Лабораторная работа №06</strong></p>
<p align="center"><strong>По дисциплине:</strong> "Веб-технологии"</p>
<p align="center"><strong>Тема:</strong> Базы данных и авторизация (SQLite + ORM + JWT)</p>
<br><br><br><br><br><br>
<p align="right"><strong>Выполнил:</strong></p>
<p align="right">Студент 4 курса</p>
<p align="right">Группы АС-64</p>
<p align="right">Немирович Д. А.</p>
<p align="right"><strong>Проверил:</strong></p>
<p align="right">Несюк А. Н.</p>
<br><br><br><br><br>
<p align="center"><strong>Брест 2025</strong></p>

---

## Цель работы

Подключение БД к серверному приложению, реализация авторизации на базе JWT и защита маршрутов. Перенос CRUD из предыдущей работы в БД.

---

### Вариант №37

#### База знаний команды: статьи, ревизии, роли редакторов

## Ход выполнения работы

### 1. Структура проекта

```
src/
├── server.js              - Основной файл сервера
├── seed.js                - Скрипт для заполнения БД
├── package.json           - Зависимости проекта
├── .env                   - Переменные окружения
├── .env.example           - Пример конфигурации
├── INSTALL.md             - Инструкция по установке
└── prisma/
    └── schema.prisma      - Схема базы данных
```

### 2. Реализованные элементы

- ORM Prisma с SQLite
- Схема БД: модели User и Article
- Хеширование паролей через bcrypt
- JWT токены для авторизации
- CRUD операции для статей
- Middleware для защиты маршрутов
- CORS настройка
- Seed скрипт для тестовых данных

### 3. API эндпоинты

#### Авторизация

**POST /api/auth/signup** - Регистрация нового пользователя

```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

**POST /api/auth/login** - Вход в систему

```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

Ответ:

```json
{
  "token": "jwt_token_here",
  "userId": 1
}
```

#### Работа со статьями

Все эндпоинты требуют заголовок:

```
Authorization: Bearer <token>
```

**GET /api/articles** - Получить все статьи

**GET /api/articles/:id** - Получить статью по ID

**POST /api/articles** - Создать новую статью

```json
{
  "title": "Название статьи",
  "content": "Содержание статьи"
}
```

**PUT /api/articles/:id** - Обновить статью

```json
{
  "title": "Новое название",
  "content": "Новое содержание"
}
```

**DELETE /api/articles/:id** - Удалить статью

### 4. Установка и запуск

1. Скопировать `.env.example` в `.env`
2. Установить зависимости: `npm install`
3. Создать миграции: `npm run migrate`
4. Заполнить БД тестовыми данными: `npm run seed`
5. Запустить сервер: `npm start`

Сервер запустится на порту 3000.

### 5. Тестовые данные

После выполнения `npm run seed` будут доступны:

- **editor@example.com** / password123
- **user@example.com** / pass456

### 6. Скриншоты выполненной лабораторной работы

![Регистрация пользователя](./screenshots/signup.png)

![Вход в систему](./screenshots/login.png)

![Получение статей](./screenshots/get_articles.png)

![Создание статьи](./screenshots/create_article.png)

---

## Таблица критериев

| Критерий                                | Выполнено |
|------------------------------------------|-----------|
| Схема БД/миграции | ✅ |
| CRUD + связь с пользователем | ✅ |
| Безопасность (хеши, JWT, защита маршрутов, CORS) | ✅ |
| Качество кода/архитектуры | ✅ |
| Тесты/валидность | ❌ |
| Документация/инструкция | ✅ |

### Дополнительные бонусы

| Бонус                                     | Выполнено |
|-------------------------------------------|-----------|
| Refresh-токены и обновление access-токена | ❌ |
| Роли/права (admin/user) | ❌ |
| Password reset flow | ❌ |

---

## Вывод

В ходе выполнения лабораторной работы была создана серверная часть приложения "База знаний команды" с использованием Node.js, Express и Prisma ORM. Реализована регистрация и авторизация пользователей с использованием JWT токенов, хеширование паролей через bcrypt. Настроена база данных SQLite со схемой для пользователей и статей. Реализованы CRUD операции для работы со статьями с защитой маршрутов через middleware. Получены практические навыки работы с ORM, JWT авторизацией и построением REST API.
