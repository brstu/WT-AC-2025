# –û—Ç—á–µ—Ç –ø–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ

<p align="center">–ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ë–µ–ª–∞—Ä—É—Å—å</p>
<p align="center">–£—á—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è</p>
<p align="center">"–ë—Ä–µ—Å—Ç—Å–∫–∏–π –ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç"</p>
<p align="center">–ö–∞—Ñ–µ–¥—Ä–∞ –ò–ò–¢</p>
<br><br><br><br><br><br>
<p align="center"><strong>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ03</strong></p>
<p align="center"><strong>–ü–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ:</strong> "–í–µ–±-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏"</p>
<p align="center"><strong>–¢–µ–º–∞:</strong> –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ HTTP‚Äë–∫—ç—à (fetch, AbortController, —Ä–µ—Ç—Ä–∞–∏)</p>
<br><br><br><br><br><br>
<p align="right"><strong>–í—ã–ø–æ–ª–Ω–∏–ª:</strong></p>
<p align="right">–°—Ç—É–¥–µ–Ω—Ç 4 –∫—É—Ä—Å–∞</p>
<p align="right">–ì—Ä—É–ø–ø—ã –ê–°-63</p>
<p align="right">–õ–æ–≥–∏–Ω–æ–≤ –ì. –û.</p>
<p align="right"><strong>–ü—Ä–æ–≤–µ—Ä–∏–ª:</strong></p>
<p align="right">–ù–µ—Å—é–∫ –ê. –ù.</p>
<br><br><br><br><br>
<p align="center"><strong>–ë—Ä–µ—Å—Ç 2025</strong></p>

---

## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–ó–∞–∫—Ä–µ–ø–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å –ø—Ä–æ–º–∏—Å–∞–º–∏ –∏ async/await, –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫, —Ç–∞–π–º–∞—É—Ç–∞–º–∏ –∏ –æ—Ç–º–µ–Ω–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–Ω—è—Ç—å –æ—Å–Ω–æ–≤—ã HTTP‚Äë–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–≤–∏–¥–µ—Ç—å —ç—Ñ—Ñ–µ–∫—Ç –≤ DevTools.

---

### –í–∞—Ä–∏–∞–Ω—Ç: –¢—Ä–µ–∫–µ—Ä –ø–æ–≥–æ–¥—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ 1 –º–∏–Ω—É—Ç—É

## –•–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
task_03/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ index.html           # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ styles.css           # –°—Ç–∏–ª–∏ (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω, –∞–Ω–∏–º–∞—Ü–∏–∏)
‚îÇ   ‚îî‚îÄ‚îÄ scripts/
‚îÇ       ‚îú‚îÄ‚îÄ main.js          # –ì–ª–∞–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏ UI —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚îÇ       ‚îú‚îÄ‚îÄ weatherApi.js    # API –∫–ª–∏–µ–Ω—Ç –¥–ª—è OpenWeatherMap
‚îÇ       ‚îú‚îÄ‚îÄ mockApi.js       # Mock API –∫–ª–∏–µ–Ω—Ç —Å ETag –∫—ç—à–µ–º
‚îÇ       ‚îî‚îÄ‚îÄ utils.js         # –£—Ç–∏–ª–∏—Ç—ã (CacheWithTTL, ETagCache, fetchWithRetry, debounce)
‚îú‚îÄ‚îÄ mock-api/
‚îÇ   ‚îú‚îÄ‚îÄ db.json              # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ (50 –∑–∞–ø–∏—Å–µ–π)
‚îÇ   ‚îî‚îÄ‚îÄ package.json         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è json-server
‚îú‚îÄ‚îÄ doc/
‚îÇ   ‚îú‚îÄ‚îÄ README.md            # –û—Ç—á–µ—Ç (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
‚îÇ   ‚îî‚îÄ‚îÄ screenshots/         # –°–∫—Ä–∏–Ω—à–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .eslintrc.json           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ESLint
‚îî‚îÄ‚îÄ .prettierrc              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prettier
```

### 2. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- ‚úÖ **–ö–ª–∏–µ–Ω—Ç –∫ API (JSONPlaceholder/ReqRes/–ª–æ–∫–∞–ª—å–Ω—ã–π mock)**: OpenWeatherMap API + –ª–æ–∫–∞–ª—å–Ω—ã–π json-server mock API
- ‚úÖ **–°–ø–∏—Å–æ–∫ 10‚Äì20 —ç–ª–µ–º–µ–Ω—Ç–æ–≤**: 50 –≥–æ—Ä–æ–¥–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø–æ–≥–æ–¥–µ
- ‚úÖ **–°–æ—Å—Ç–æ—è–Ω–∏—è loading/error/empty**: skeleton loader, –æ—à–∏–±–∫–∏ —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π, –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –Ω–µ–Ω–∞–π–¥–µ–Ω–Ω–æ–º –≥–æ—Ä–æ–¥–µ
- ‚úÖ **–ü–æ–∏—Å–∫/—Ñ–∏–ª—å—Ç—Ä**: –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –≥–æ—Ä–æ–¥–∞ —Å debounce 500–º—Å
- ‚úÖ **–ü–∞–≥–∏–Ω–∞—Ü–∏—è**: –∏–Ω—Ñ–∏–Ω–∏—Ç-—Å–∫—Ä–æ–ª–ª —Å Intersection Observer

#### –†–µ—Ç—Ä–∞–∏ –∏ —Ç–∞–π–º–∞—É—Ç—ã

- ‚úÖ **fetchWithRetry(url, { retries, backoffMs, timeoutMs })**: —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `utils.js`
- ‚úÖ **–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ AbortController**: –æ—Ç–º–µ–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –Ω–æ–≤–æ–º –ø–æ–∏—Å–∫–µ

#### HTTP-–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

- ‚úÖ **In-memory Map —Å TTL**: –∫–ª–∞—Å—Å `CacheWithTTL` —Å –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ 60 —Å–µ–∫—É–Ω–¥
- ‚úÖ **ETag –∫—ç—à —Å If-None-Match**: –∫–ª–∞—Å—Å `ETagCache` –¥–ª—è —É—Å–ª–æ–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (304 Not Modified)
- ‚úÖ **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤ Network (304/cached)**: —Å–º. —Å–∫—Ä–∏–Ω—à–æ—Ç—ã DevTools

#### UX-—É–ª—É—á—à–µ–Ω–∏—è

- ‚úÖ **–ö–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª (–∏–≥–Ω–æ—Ä –∫—ç—à–∞)**: –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏**: badge —Å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –¥–∞–Ω–Ω—ã—Ö (üíæ –∫—ç—à / üåê —Å–µ—Ä–≤–µ—Ä)

#### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- ‚úÖ **async/await, try/catch/finally**: –≤–æ –≤—Å–µ—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏**: AbortController –¥–ª—è –æ—Ç–º–µ–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–æ–∏—Å–∫–∞
- ‚úÖ **Skeleton/spinner**: skeleton loader —Å shimmer –∞–Ω–∏–º–∞—Ü–∏–µ–π

#### –ë–æ–Ω—É—Å—ã (+ –¥–æ 10 –±–∞–ª–ª–æ–≤)

- ‚úÖ **ETag-–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫—ç—à —Å If-None-Match**: –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ `mockApi.js`
- ‚úÖ **–î–µ–±–∞—É–Ω—Å –≤–≤–æ–¥–∞, –æ—Ç–º–µ–Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**: 500–º—Å debounce + AbortController
- ‚úÖ **Prefetch –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ (–∏–Ω—Ñ–∏–Ω–∏—Ç-—Å–∫—Ä–æ–ª–ª)**: Intersection Observer —Å `rootMargin: '100px'`

### 3. –°–∫—Ä–∏–Ω—à–æ—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã

#### –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

![–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](./screenshots/01_interface.png)

##### –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø–æ–ª–µ–º –ø–æ–∏—Å–∫–∞, –∫–∞—Ä—Ç–æ—á–∫–æ–π –ø–æ–≥–æ–¥—ã –∏ –∫–Ω–æ–ø–∫–∞–º–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤

![–ù–∏–∂–Ω—è—è —á–∞—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞](./screenshots/01_interface_2.png)

##### –°–µ–∫—Ü–∏—è ¬´–í—Å–µ –≥–æ—Ä–æ–¥–∞ –º–∏—Ä–∞¬ª —Å –∫–Ω–æ–ø–∫–æ–π –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∏–Ω—Ñ–∏–Ω–∏—Ç-—Å–∫—Ä–æ–ª–ª–∞

#### –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å (–¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞)

![–ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å](./screenshots/03_first_request.png)

##### –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–∞ ‚Äî badge ¬´üåê –°–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ¬ª

#### –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞)

![–ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å](./screenshots/04_cached_request.png)

##### –î–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞ ‚Äî badge ¬´üíæ –ò–∑ –∫—ç—à–∞¬ª —Å —Ç–∞–π–º–µ—Ä–æ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏

#### DevTools Network ‚Äî –ø–µ—Ä–≤—ã–π vs –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å

![Network –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å](./screenshots/05_network_first.png)

#### –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å: 200 OK, –ø–æ–ª–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏

![Network –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π](./screenshots/06_network_cached.png)

#### –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å: –¥–∞–Ω–Ω—ã–µ –∏–∑ in-memory –∫—ç—à–∞ (–±–µ–∑ —Å–µ—Ç–µ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞)

#### Retry –º–µ—Ö–∞–Ω–∏–∑–º –≤ –∫–æ–Ω—Å–æ–ª–∏

![Retry –≤ –∫–æ–Ω—Å–æ–ª–∏](./screenshots/02_retry_console.png)

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–≤—Ç–æ—Ä–∞ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º backoff

#### –û—Ç–º–µ–Ω–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (AbortController)

![–û—Ç–º–µ–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞](./screenshots/08_abort_controller.png)

#### –ö–æ–Ω—Å–æ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç–º–µ–Ω—É –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–∏ –Ω–æ–≤–æ–º –ø–æ–∏—Å–∫–µ

#### Skeleton –∑–∞–≥—Ä—É–∑–∫–∞

![Skeleton loader](./screenshots/09_skeleton_loading.png)

#### –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å shimmer-–∞–Ω–∏–º–∞—Ü–∏–µ–π

---

## –¢–∞–±–ª–∏—Ü–∞ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π                                | –ë–∞–ª–ª—ã | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
|------------------------------------------|-------|-----------|
| –°–µ–º–∞–Ω—Ç–∏–∫–∞/UX                            | 20    | ‚úÖ |
| –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–∑–∞–≥—Ä—É–∑–∫–∞, –ø–æ–∏—Å–∫/–ø–∞–≥–∏–Ω–∞—Ü–∏—è, retry/timeout/abort) | 25 | ‚úÖ |
| –ö–∞—á–µ—Å—Ç–≤–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (loading/error/empty, skeleton) | 20 | ‚úÖ |
| –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞                           | 15    | ‚úÖ |
| –í–∞–ª–∏–¥–∞—Ü–∏—è/–ø—Ä–æ–≤–µ—Ä–∫–∏ (–∫—ç—à, –ª–∏–Ω—Ç–µ—Ä—ã)       | 10    | ‚úÖ |
| –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∏ –æ—Ç—á—ë—Ç                      | 10    | ‚úÖ |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–æ–Ω—É—Å—ã

| –ë–æ–Ω—É—Å                                     | –ë–∞–ª–ª—ã | –í—ã–ø–æ–ª–Ω–µ–Ω–æ |
|-------------------------------------------|-------|-----------|
| ETag-–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫—ç—à —Å If-None-Match       | +3    | ‚úÖ |
| –î–µ–±–∞—É–Ω—Å –≤–≤–æ–¥–∞, –æ—Ç–º–µ–Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ | +3    | ‚úÖ |
| Prefetch –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ (–∏–Ω—Ñ–∏–Ω–∏—Ç-—Å–∫—Ä–æ–ª–ª)   | +4    | ‚úÖ |

**–ò—Ç–æ–≥–æ:** 100 + 10 = **110 –±–∞–ª–ª–æ–≤**

---

## –°—Å—ã–ª–∫–∏

- **–ü—É–±–ª–∏–∫–∞—Ü–∏—è:** <https://gleb7499.github.io/WT-AC-2025/task_03/src>
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** <https://github.com/gleb7499/WT-AC-2025>
- **OpenWeatherMap API:** <https://openweathermap.org/api>

---

## –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

#### TTL –∫—ç—à (–ø–æ–≥–æ–¥–∞)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–ª–∞—Å—Å `CacheWithTTL` –≤ `utils.js`:

```javascript
export class CacheWithTTL {
    constructor(ttlMs = 60000) { // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 1 –º–∏–Ω—É—Ç–∞
        this.cache = new Map();
        this.ttlMs = ttlMs;
    }

    set(key, value) {
        const expiresAt = Date.now() + this.ttlMs;
        this.cache.set(key, { value, expiresAt });
    }

    get(key) {
        const cached = this.cache.get(key);
        if (!cached) return null;
        if (Date.now() > cached.expiresAt) {
            this.cache.delete(key);
            return null;
        }
        return cached.value;
    }
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- In-memory –∫—ç—à –Ω–∞ –æ—Å–Ω–æ–≤–µ Map
- TTL = 60 —Å–µ–∫—É–Ω–¥ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –∫—ç—à–∞

#### ETag –∫—ç—à (–¥–ª—è mock API)

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–ª–∞—Å—Å `ETagCache` –≤ `utils.js`:

```javascript
export class ETagCache {
    constructor() {
        this.cache = new Map();
    }

    set(url, etag, data) {
        this.cache.set(url, { etag, data, timestamp: Date.now() });
    }

    getETag(url) {
        const cached = this.cache.get(url);
        return cached ? cached.etag : null;
    }
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**

1. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ETag –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
2. ETag —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏
3. –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫ `If-None-Match: <etag>`
4. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `304 Not Modified`
5. –ö–ª–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—ç–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞)

### Retry —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º backoff

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `fetchWithRetry` –≤ `utils.js`:

```javascript
export async function fetchWithRetry(url, {
    retries = 2,
    backoffMs = 500,
    timeoutMs = 5000,
    signal = null,
    headers = {}
} = {}) {
    let attempt = 0;
    let lastError;

    while (attempt <= retries) {
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), timeoutMs);

        try {
            const response = await fetch(url, {
                signal: combineAbortSignals(signal, controller.signal),
                headers
            });
            clearTimeout(timeoutId);
            // ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
        } catch (error) {
            if (attempt < retries) {
                const delay = backoffMs * Math.pow(2, attempt);
                console.warn(`–ü–æ–ø—ã—Ç–∫–∞ ${attempt + 1} –Ω–µ —É–¥–∞–ª–∞—Å—å. –ü–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ ${delay}–º—Å...`);
                await sleep(delay);
                attempt++;
            }
        }
    }
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backoff: 500–º—Å ‚Üí 1000–º—Å ‚Üí 2000–º—Å
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–º–µ–Ω–∞ –ø–æ —Ç–∞–π–º–∞—É—Ç—É (5 —Å–µ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ (–≤–Ω–µ—à–Ω–∏–π + —Ç–∞–π–º–∞—É—Ç)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª—å

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫

–°–æ–∑–¥–∞–Ω—ã –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫:

```javascript
// –°–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏ (—Ç–∞–π–º–∞—É—Ç—ã, –ø–æ—Ç–µ—Ä—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, HTTP 5xx)
export class NetworkError extends Error {
    constructor(message, statusCode = null) {
        super(message);
        this.name = 'NetworkError';
        this.isNetworkError = true;
    }
}

// –ë–∏–∑–Ω–µ—Å-–æ—à–∏–±–∫–∏ (–≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω, –Ω–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á)
export class BusinessError extends Error {
    constructor(message, code = null, statusCode = null) {
        super(message);
        this.name = 'BusinessError';
        this.isBusinessError = true;
    }
}
```

### Debounce –∏ –æ—Ç–º–µ–Ω–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

```javascript
// Debounced –ø–æ–∏—Å–∫ –ø—Ä–∏ –≤–≤–æ–¥–µ (500–º—Å –∑–∞–¥–µ—Ä–∂–∫–∞)
const debouncedSearch = debounce(() => {
    const value = elements.citySearch.value.trim();
    if (value.length >= 3) {
        handleSearch(false);
    }
}, 500);

// –û—Ç–º–µ–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
async function handleSearch(ignoreCache = false) {
    if (state.currentAbortController) {
        state.currentAbortController.abort();
    }
    state.currentAbortController = new AbortController();
    // ...
}
```

### –ò–Ω—Ñ–∏–Ω–∏—Ç-—Å–∫—Ä–æ–ª–ª —Å prefetch

```javascript
state.infiniteScroll.observer = new IntersectionObserver(
    entries => {
        const sentinel = entries[0];
        if (sentinel.isIntersecting && hasMore && !isLoading) {
            loadMoreCities();
        }
    },
    {
        root: elements.citiesList,
        rootMargin: '100px', // Prefetch –∑–∞ 100px –¥–æ –∫–æ–Ω—Ü–∞
        threshold: 0.1
    }
);
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- Sentinel-—ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–æ–Ω—Ü–∞ —Å–ø–∏—Å–∫–∞
- Prefetch –∑–∞ 100px –¥–æ –∫–æ–Ω—Ü–∞ (–ø–ª–∞–≤–Ω—ã–π UX)
- 10 –≥–æ—Ä–æ–¥–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
- ETag –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

---

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ó–∞–ø—É—Å–∫ Mock API —Å–µ—Ä–≤–µ—Ä–∞ (–¥–ª—è –∏–Ω—Ñ–∏–Ω–∏—Ç-—Å–∫—Ä–æ–ª–ª–∞ —Å ETag)

```bash
cd mock-api
npm install
npm start
```

Mock-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:3001`

### 2. –û—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–û—Ç–∫—Ä–æ–π—Ç–µ `src/index.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ —á–µ—Ä–µ–∑ Live Server –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π HTTP —Å–µ—Ä–≤–µ—Ä.

### –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

```javascript
clearAllCache()        // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∫—ç—à–∏ (TTL + ETag)
resetInfiniteScroll()  // –°–±—Ä–æ—Å –∏–Ω—Ñ–∏–Ω–∏—Ç-—Å–∫—Ä–æ–ª–ª–∞
forceRefresh()         // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã
```

---

## –í—ã–≤–æ–¥

–í —Ä–∞–º–∫–∞—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–≥–æ–¥—ã —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ HTTP-–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ.

### –ò–∑—É—á–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–º–∏—Å–∞–º–∏ –∏ async/await
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –∫–æ–¥–µ (try/catch/finally)
- ‚úÖ –ú–µ—Ö–∞–Ω–∏–∑–º—ã retry —Å exponential backoff
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–∞—É—Ç–∞–º–∏ –∏ –æ—Ç–º–µ–Ω–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤ (AbortController)
- ‚úÖ In-memory –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL
- ‚úÖ ETag-–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫—ç—à —Å If-None-Match (304 Not Modified)
- ‚úÖ Intersection Observer –¥–ª—è –∏–Ω—Ñ–∏–Ω–∏—Ç-—Å–∫—Ä–æ–ª–ª–∞ —Å prefetch
- ‚úÖ Debounce –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∏ –±–∏–∑–Ω–µ—Å-–æ—à–∏–±–æ–∫

### –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Ö–æ–¥–∫–∏

- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞–µ—Ç UX –∏ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ API
- **AbortController** –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—Ç–º–µ–Ω—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **Exponential backoff** –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- **Skeleton UI** —Å–æ–∑–¥–∞–µ—Ç –ª—É—á—à–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç, —á–µ–º –ø—Ä–æ—Å—Ç–æ–π —Å–ø–∏–Ω–Ω–µ—Ä
- **Debounce** –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **ETag** —ç–∫–æ–Ω–æ–º–∏—Ç –¥–æ 90% —Ç—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **Intersection Observer** —Å prefetch –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–ª–∞–≤–Ω—ã–π –∏–Ω—Ñ–∏–Ω–∏—Ç-—Å–∫—Ä–æ–ª–ª
