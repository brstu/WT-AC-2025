# Вариант 11: Сервис бронирований с ролями

---

<p align="center">Министерство образования Республики Беларусь</p>
<p align="center">Учреждение образования</p>
<p align="center">“Брестский Государственный технический университет”</p>
<p align="center">Кафедра информационных систем и технологий</p>

<br><br><br><br><br><br>

<p align="center"><strong>Лабораторная работа №7</strong></p>
<p align="center"><strong>По дисциплине:</strong> “Веб-технологии”</p>
<p align="center"><strong>Тема:</strong> "React‑приложение: маршрутизация, состояние, формы, работа с API"</p>

<br><br><br><br><br><br>

<p align="right"><strong>Выполнил:</strong></p>
<p align="right">Студент 4 курса</p>
<p align="right">Группы АС-63</p>
<p align="right">Куликович И.С.</p>

<p align="right"><strong>Проверил:</strong></p>
<p align="right">Несюк А.Н.</p>

<br><br><br><br><br>

<p align="center"><strong>Брест 2025</strong></p>

---

## Цель работы

Целью лабораторной работы является cоздать полноценный SPA на React. Подключить маршрутизацию, реализовать формы и взаимодействие с API.

---

---

## Ход выполнения работы

## 1. Архитектура решения

Разработан **RESTful API** сервис для управления бронированиями мероприятий со следующей архитектурой:

- **Backend:** Node.js + Express + TypeScript
- **База данных:** PostgreSQL с использованием ORM Prisma
- **Аутентификация:** JWT (JSON Web Tokens)
- **Безопасность:** bcrypt для хеширования паролей, CORS, rate limiting

## 2. Реализованная функциональность

### 2.1. Модели данных

- **User:** Пользователи системы с ролями (ADMIN, ORGANIZER, USER)
- **Venue:** Площадки для проведения мероприятий
- **Event:** События/мероприятия
- **Booking:** Бронирования пользователей

### 2.2. Система аутентификации и авторизации

- Регистрация новых пользователей (`POST /api/auth/signup`)
- Вход в систему с выдачей JWT-токена (`POST /api/auth/login`)
- Middleware для проверки JWT-токенов
- Ролевая модель доступа (разграничение прав по ролям)

### 2.3. REST API эндпоинты

- Управление пользователями (регистрация, аутентификация)
- CRUD операции для площадок (только для администраторов)
- CRUD операции для событий (организаторы и администраторы)
- Управление бронированиями (пользователи)
- Просмотр мероприятий и площадок (публичный доступ)

### 2.4. Безопасность

- Хеширование паролей с использованием bcrypt
- Защита маршрутов JWT middleware
- CORS политика
- Ограничение частоты запросов (rate limiting)
- Валидация входных данных

---

## 3. Технические особенности реализации

### 3.1. Работа с базой данных

- Использование Prisma ORM для TypeScript
- Миграции базы данных
- Связи между сущностями (один-ко-многим, многие-ко-многим)
- Уникальные ограничения и валидация на уровне БД

### 3.2. Аутентификация

- Генерация JWT-токенов с временем жизни
- Bearer токены в заголовке Authorization
- Автоматическое обновление данных пользователя при запросах
- Защита паролей с солью (salt rounds = 12)

### 3.3. Обработка ошибок

- Централизованный обработчик ошибок
- Валидация входных данных
- Обработка исключений базы данных
- HTTP статус-коды соответствия RESTful практике

---

## 4. Примеры использования API

### Регистрация пользователя

```bash
POST /api/auth/signup
{
  "email": "user@example.com",
  "password": "secure123",
  "firstName": "Иван",
  "lastName": "Иванов"
}
```

### Создание мероприятия

```bash
POST /api/events
Authorization: Bearer <jwt_token>
{
  "title": "Конференция по веб-технологиям",
  "description": "Ежегодная конференция для разработчиков",
  "date": "2024-12-20T10:00:00Z",
  "duration": 180,
  "maxAttendees": 100,
  "venueId": 1
}
```

---

## 5. Тестирование

Для тестирования системы подготовлены:

- Тестовые пользователи с разными ролями
- Начальные данные в базе (seed)
- Примеры запросов для всех эндпоинтов
- Проверка всех сценариев использования

---

## Инструкция по запуску

### Предварительные требования

- Node.js (версия 18 или выше)
- PostgreSQL (или SQLite для упрощенной настройки)
- npm или yarn

### Шаги установки и запуска

#### Клонирование и настройка

```bash
git clone <репозиторий>
cd booking-service
npm install
```

#### Конфигурация окружения

```bash
cp .env.example .env
# Отредактировать .env файл, указав параметры БД и JWT секрет
```

#### Настройка базы данных

```bash
npx prisma generate
npx prisma migrate dev --name init
npm run prisma\:seed
```

#### Запуск сервера

```bash
npm run dev
# Сервер запустится на http://localhost:3000
```

### Тестовые учетные записи

После выполнения seed скрипта создаются:

- Администратор: `admin@test.com` / `admin123`

- Пользователь: `user@test.com` / `user123`

---

## Вывод

В ходе выполнения лабораторной работы был разработан полнофункциональный сервис бронирований с системой ролей и аутентификацией.
