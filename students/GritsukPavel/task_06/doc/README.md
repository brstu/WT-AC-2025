# Лабораторная работа №6

<p align="center">Министерство образования Республики Беларусь</p>
<p align="center">Учреждение образования</p>
<p align="center">"Брестский Государственный технический университет"</p>
<p align="center">Кафедра ИИТ</p>
<br><br><br><br><br><br>
<p align="center"><strong>Лабораторная работа №6</strong></p>
<p align="center"><strong>По дисциплине:</strong> "Веб-технологии"</p>
<p align="center"><strong>Тема:</strong> Базы данных и авторизация (SQLite + ORM + JWT)</p>
<br><br><br><br><br><br>
<p align="right"><strong>Выполнил:</strong></p>
<p align="right">Студент 4 курса</p>
<p align="right">Группы АС-63</p>
<p align="right">Грицук П. Э.</p>
<p align="right"><strong>Проверил:</strong></p>
<p align="right">Несюк А. Н.</p>
<br><br><br><br><br>
<p align="center"><strong>Брест 2025</strong></p>

---

## Цель работы

Настроить ORM и схему данных (SQLite), реализовать регистрацию/логин, выдачу JWT, middleware защиты и доступ к задачам только владельца.

---

### Вариант №4

#### Личный дневник (приватные записи, JWT защита)

## Ход выполнения работы

### 1. Структура проекта

```
src/
├── server.js          — основной файл сервера с Express
├── package.json       — зависимости проекта
├── .env.example       — пример переменных окружения
├── .gitignore         — игнорируемые файлы
└── public/
    └── index.html     — клиентская часть приложения
```

### 2. Реализованные элементы

- **ORM**: Использован Sequelize с SQLite
- **Схема БД**: Две таблицы - User (пользователи) и Entry (записи дневника)
- **Авторизация**: Регистрация `/api/auth/signup` и вход `/api/auth/login`
- **JWT**: Токены выдаются при входе, срок действия 24 часа
- **Middleware**: Функция `auth` проверяет Bearer-токен
- **CRUD**: Полный набор операций для записей дневника
- **Безопасность**: Хеширование паролей с bcrypt, CORS, ограничение размера запросов
- **Защита маршрутов**: Пользователи видят только свои записи

### 3. Скриншоты выполненой лабораторной работы

#### Страница авторизации

![Авторизация](https://via.placeholder.com/800x450/667eea/ffffff?text=%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0+%D0%B0%D0%B2%D1%82%D0%BE%D1%80%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8)

#### Главная страница с записями

![Записи дневника](https://via.placeholder.com/800x450/764ba2/ffffff?text=%D0%97%D0%B0%D0%BF%D0%B8%D1%81%D0%B8+%D0%B4%D0%BD%D0%B5%D0%B2%D0%BD%D0%B8%D0%BA%D0%B0)

#### Создание новой записи

![Новая запись](https://via.placeholder.com/800x450/5568d3/ffffff?text=%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5+%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B8)

---

## Инструкция по запуску

### Установка зависимостей

```bash
cd src
npm install
```

### Настройка переменных окружения

Создать файл `.env` на основе `.env.example`:

```
JWT_SECRET=supersecretkey123456
PORT=3000
```

### Запуск сервера

```bash
npm start
```

Сервер запустится на `http://localhost:3000`

### Использование API

**Регистрация:**

```bash
POST /api/auth/signup
{
  "username": "user1",
  "password": "password123",
  "email": "user@example.com"
}
```

**Вход:**

```bash
POST /api/auth/login
{
  "username": "user1",
  "password": "password123"
}
```

Ответ содержит токен:

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "userId": 1,
  "username": "user1"
}
```

**Получение записей:**

```bash
GET /api/entries
Authorization: Bearer <token>
```

**Создание записи:**

```bash
POST /api/entries
Authorization: Bearer <token>
{
  "title": "Моя запись",
  "content": "Сегодня был хороший день",
  "mood": "счастливый"
}
```

**Удаление записи:**

```bash
DELETE /api/entries/:id
Authorization: Bearer <token>
```

---

## Таблица критериев

| Критерий                                          | Статус |
|---------------------------------------------------|-----------|
| Схема БД/миграции                                 | ✓        |
| CRUD + связь с пользователем                      | ✓        |
| Безопасность (хеши, JWT, защита маршрутов, CORS)  | ✓        |
| Качество кода/архитектуры                         | Базовый  |
| Валидность и обработка ошибок                     | Базовая  |
| Документация/инструкция                           | ✓        |

### Компоненты без реализации

| Компонент                                         | Причина |
|---------------------------------------------------|-----------|
| Refresh-токены                                    | Не требуется в минимальной версии |
| Роли/права (admin/user)                           | Не требуется в минимальной версии |
| Password reset flow                               | Не требуется в минимальной версии |

## Вывод

В ходе выполнения лабораторной работы был создан веб-сервис личного дневника с использованием Node.js, Express и SQLite. Реализована система авторизации на основе JWT-токенов, обеспечивающая защищенный доступ к приватным записям пользователей. Использован ORM Sequelize для работы с базой данных, что позволяет удобно управлять схемой и выполнять запросы. Применено хеширование паролей с помощью bcrypt для обеспечения безопасности учетных данных. Каждый пользователь имеет доступ только к своим записям благодаря проверке владельца через middleware.
